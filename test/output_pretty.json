[
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u4eca\u5e74\u65e9\u4e9b\u65f6\u5019\uff0c\u5947\u821e\u56e2\u5f00\u6e90\u7684 Node.js \u6846\u67b6 \u2500\u2500"
      },
      {
        "name": "a",
        "attrs": {
          "class": "rich-text-a"
        },
        "children": [
          {
            "type": "text",
            "text": "ThinkJS"
          }
        ]
      },
      {
        "type": "text",
        "text": "\u8fce\u6765\u4e86\u5979\u7684 3.0 \u7248\u672c\u3002\u5c3d\u7ba1\u4eca\u5e74\u6211\u5f88\u5c11\u66f4\u65b0\u535a\u5ba2\uff0c\u4f46\u300c\u6bcf\u6b21 ThinkJS \u53d1\u5e03\u5927\u7248\u672c\uff0c\u6211\u90fd\u8981\u66f4\u65b0\u535a\u5ba2\u7a0b\u5e8f\u300d\u7684\u8001\u4f20\u7edf\u8fd8\u662f\u4e0d\u80fd\u4e22\u3002\u6240\u4ee5\uff0c\u4f60\u73b0\u5728\u770b\u5230\u7684\u8fd9\u4e2a\u535a\u5ba2\uff0c\u5df2\u7ecf\u662f\u57fa\u4e8e ThinkJS 3 \u5168\u9762\u91cd\u6784\u540e\u7684\u65b0\u7248\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "ThinkJS 3 \u57fa\u4e8e"
      },
      {
        "name": "a",
        "attrs": {
          "class": "rich-text-a"
        },
        "children": [
          {
            "type": "text",
            "text": "Koa"
          }
        ]
      },
      {
        "type": "text",
        "text": "2.x \u5f00\u53d1\uff0c\u5185\u6838\u5b9e\u73b0\u5f97\u975e\u5e38\u5c0f\u5de7\uff0c\u6846\u67b6\u901a\u8fc7 Middleware\uff08\u517c\u5bb9 Koa\uff09\u3001Adapter\u3001Extend \u7b49\u673a\u5236\u6765\u6269\u5c55\u51fa\u5f3a\u5927\u800c\u4e30\u5bcc\u7684\u529f\u80fd\u3002\u6309\u7167\u60ef\u4f8b\uff0cThinkJS \u5927\u7248\u672c\u4e4b\u95f4\u65e0\u6cd5\u5e73\u6ed1\u8fdb\u884c\uff0c\u4f46\u8fd9\u6b21\u5347\u7ea7\u5e26\u6765\u7684\u5de5\u4f5c\u91cf\u4e0d\u7b97\u592a\u5927\uff0c\u672c\u7ad9\u7684\u5347\u7ea7\u5de5\u4f5c\u82b1\u4e86\u4e00\u4e0b\u5348\u5168\u90e8\u5b8c\u6210\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u57fa\u4e8e ThinkJS \u5f00\u53d1\u7684\u7f51\u7ad9\u666e\u904d\u90fd\u5f88\u5feb\uff0c\u8fd9\u7bc7\u6587\u7ae0\u6211\u6253\u7b97\u804a\u804a\u5982\u4f55\u4e3a ThinkJS 3 \u7f51\u7ad9\u4f18\u5316 TTFB \u65f6\u95f4\uff0c\u4f7f\u4e4b\u53d8\u5f97\u66f4\u5feb\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "Time to first byte\uff08\u7b80\u79f0 TTFB\uff09\u65f6\u95f4\uff0c\u53c8\u79f0\u9996\u5b57\u8282\u65f6\u95f4\uff0c\u662f WEB \u6027\u80fd\u4f18\u5316\u4e2d\u975e\u5e38\u91cd\u8981\u7684\u6307\u6807\u3002\u5b83\u4ee3\u8868\u7740\u4ece\u6d4f\u89c8\u5668\u53d1\u8d77 HTTP \u8bf7\u6c42\u5230\u6536\u5230 HTTP \u54cd\u5e94\u7b2c\u4e00\u4e2a\u5b57\u8282\u7684\u8fd9\u6bb5\u65f6\u95f4\uff0c\u5305\u542b\u4e86 DNS \u89e3\u6790\u3001\u5efa\u7acb TCP \u8fde\u63a5\u3001\u5efa\u7acb SSL \u8fde\u63a5\u3001\u53d1\u9001 HTTP \u8bf7\u6c42\u3001\u7f51\u7edc\u4f20\u8f93\u3001\u670d\u52a1\u7aef\u5904\u7406\u300130X \u91cd\u5b9a\u5411\u7b49\u9636\u6bb5\u3002\u5728\u5f71\u54cd TTFB \u6240\u6709\u56e0\u7d20\u4e2d\uff0c\u670d\u52a1\u7aef\u7a0b\u5e8f\u4f55\u65f6\u8f93\u51fa\u54cd\u5e94\u51b3\u5b9a\u4e86\u670d\u52a1\u7aef\u5904\u7406\u65f6\u95f4\u7684\u957f\u77ed\uff0c\u4e5f\u662f\u672c\u6587\u5173\u6ce8\u7684\u4f18\u5316\u76ee\u6807\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u4f18\u5316 WEB \u9875\u9762\u7684 TTFB\u65f6\u95f4\u9664\u4e86\u8981\u5c3d\u53ef\u80fd\u4f18\u5316\u4e1a\u52a1\u903b\u8f91\u4e4b\u5916\uff0c\u8fd8\u6709\u4e24\u4e2a\u5e38\u7528\u6280\u5de7\uff1a"
      }
    ]
  },
  {
    "name": "ul",
    "attrs": {
      "class": "rich-text-ul"
    },
    "children": [
      {
        "name": "li",
        "attrs": {
          "class": "rich-text-li"
        },
        "children": [
          {
            "type": "text",
            "text": "\u591a\u4e2a HTTP \u8bf7\u6c42\u54cd\u5e94\uff08\u52a8\u9759\u62c6\u5206\uff09\uff1b"
          }
        ]
      },
      {
        "name": "li",
        "attrs": {
          "class": "rich-text-li"
        },
        "children": [
          {
            "type": "text",
            "text": "\u4e00\u4e2a HTTP \u8bf7\u6c42\u591a\u6b21\u54cd\u5e94\uff08\u5206\u5757\u4f20\u8f93\uff09\uff1b"
          }
        ]
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u524d\u8005\u65e0\u975e\u5c31\u662f\u5148\u5c3d\u5feb\u8f93\u51fa\u4e00\u4e2a\u65e0\u670d\u52a1\u7aef\u590d\u6742\u903b\u8f91\u7684\u7a7a\u58f3\u9875\u9762\uff0c\u518d\u53d1\u8d77 ajax\u3001jsonp \u7b49\u5f02\u6b65\u8bf7\u6c42\u586b\u5145\u5185\u5bb9\u3002\u8fd9\u79cd\u65b9\u6848\u4e0d\u5229\u4e8e SEO\uff0c\u6bd4\u8f83\u9002\u7528\u4e8e\u5355\u9875\u5e94\u7528\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u50cf\u672c\u7ad9\u8fd9\u79cd\u4ee5\u5185\u5bb9\u4e3a\u4e3b\u7684 Web \u9875\u9762\uff0c\u975e\u5e38\u9002\u5408\u91c7\u7528\u7b2c\u4e8c\u4e2a\u6280\u5de7\u6765\u4f18\u5316 TTFB\u65f6\u95f4\u3002\u672c\u6587\u91cd\u70b9\u4ecb\u7ecd\u5b83\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u5206\u5757\u4f20\u8f93\u54cd\u5e94\u9700\u8981\u7528\u5230\u6211\u4e4b\u524d\u4ecb\u7ecd\u8fc7\u7684"
      },
      {
        "name": "a",
        "attrs": {
          "class": "rich-text-a"
        },
        "children": [
          {
            "type": "text",
            "text": "HTTP Transfer-Encoding: chunked"
          }
        ]
      },
      {
        "type": "text",
        "text": "\u673a\u5236\u3002\u6709\u4e86\u8fd9\u4e2a\u673a\u5236\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u968f\u65f6\u5c06\u5df2\u7ecf\u5b8c\u6210\u7684\u90e8\u5206\u54cd\u5e94\u53d1\u9001\u7ed9\u7ed9\u5ba2\u6237\u7aef\uff0c\u800c\u4e0d\u5fc5\u7b49\u5f85\u5168\u90e8\u5b8c\u6210\u540e\u518d\u4e00\u6b21\u53d1\u9001\u3002\u6d4f\u89c8\u5668\u62ff\u5230\u90e8\u5206\u54cd\u5e94\uff0c\u5c31\u80fd\u89e3\u6790\u5e76\u6267\u884c\u5176\u4e2d\u7684 HTML\u3001CSS \u548c JS \u4ee3\u7801\uff0c\u8fd8\u80fd\u52a0\u8f7d\u5176\u4e2d\u5f15\u7528\u7684\u5b50\u8d44\u6e90\uff0c\u6700\u7ec8\u8ba9\u7528\u6237\u66f4\u5feb\u770b\u5230\u90e8\u5206\u9875\u9762\u5185\u5bb9\u3002\u5206\u5757\u4f20\u8f93\u4e5f\u662f Facebook \u5728 2009 \u5e74\u5b9e\u73b0\u7684 Bigpipe \u65b9\u6848\u7684\u7406\u8bba\u57fa\u7840\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u518d\u6765\u8bf4\u8bf4 ThinkJS\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u5728 ThinkJS \u4e4b\u524d\u51e0\u4e2a\u7248\u672c\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7"
      },
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "type": "text",
            "text": "http.write(content)"
          }
        ]
      },
      {
        "type": "text",
        "text": "\u53d1\u9001\u591a\u4e2a chunk\uff0c\u518d\u901a\u8fc7"
      },
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "type": "text",
            "text": "http.end(content)"
          }
        ]
      },
      {
        "type": "text",
        "text": "\u53d1\u9001\u6700\u540e\u4e00\u4e2a chunk\uff0c\u975e\u5e38\u65b9\u4fbf\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u800c ThinkJS 3 \u4f7f\u7528\u7684 Koa 2.x\uff0c\u53ea\u80fd\u901a\u8fc7"
      },
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "type": "text",
            "text": "ctx.body"
          }
        ]
      },
      {
        "type": "text",
        "text": "\u8bbe\u7f6e\u5e76\u7ed3\u675f\u54cd\u5e94\uff0c\u610f\u5473\u7740\u901a\u5e38\u60c5\u51b5\u4e0b\u54cd\u5e94\u53ea\u80fd\u53d1\u9001\u4e00\u6b21\uff0c\u8fd8\u5f97\u653e\u5728\u6574\u4e2a Controller \u6d41\u7a0b\u7684\u6700\u540e\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u901a\u8fc7\u5206\u6790\u4ee3\u7801\uff0c\u6211\u627e\u5230\u5728 ThinkJS 3 \u4e2d\u591a\u6b21\u53d1\u9001\u54cd\u5e94\u7684\u4e24\u79cd\u65b9\u6848\uff1a"
      }
    ]
  },
  {
    "name": "ul",
    "attrs": {
      "class": "rich-text-ul"
    },
    "children": [
      {
        "name": "li",
        "attrs": {
          "class": "rich-text-li"
        },
        "children": [
          {
            "name": "code",
            "attrs": {
              "class": "rich-text-code"
            },
            "children": [
              {
                "type": "text",
                "text": "ctx.body"
              }
            ]
          },
          {
            "type": "text",
            "text": "\u652f\u6301\u4f20\u5165 Stream\uff0c\u521b\u5efa Readable \u6d41"
          },
          {
            "name": "code",
            "attrs": {
              "class": "rich-text-code"
            },
            "children": [
              {
                "type": "text",
                "text": "rs"
              }
            ]
          },
          {
            "type": "text",
            "text": "\u5e76\u591a\u6b21\u8c03\u7528"
          },
          {
            "name": "code",
            "attrs": {
              "class": "rich-text-code"
            },
            "children": [
              {
                "type": "text",
                "text": "rs.push(content)"
              }
            ]
          },
          {
            "type": "text",
            "text": "\u53ef\u4ee5\u591a\u6b21\u53d1\u9001 chunk\uff0c\u8c03\u7528"
          },
          {
            "name": "code",
            "attrs": {
              "class": "rich-text-code"
            },
            "children": [
              {
                "type": "text",
                "text": "rs.push(null)"
              }
            ]
          },
          {
            "type": "text",
            "text": "\u53ef\u4ee5\u7ed3\u675f\u54cd\u5e94\uff1b"
          }
        ]
      },
      {
        "name": "li",
        "attrs": {
          "class": "rich-text-li"
        },
        "children": [
          {
            "type": "text",
            "text": "Koa \u4ee3\u7801\u5c42\u9762\u4e0a\u5e76\u6ca1\u6709\u7981\u6b62\u6211\u4eec\u4f7f\u7528"
          },
          {
            "name": "code",
            "attrs": {
              "class": "rich-text-code"
            },
            "children": [
              {
                "type": "text",
                "text": "ctx.res"
              }
            ]
          },
          {
            "type": "text",
            "text": "\uff0c\u901a\u8fc7"
          },
          {
            "name": "code",
            "attrs": {
              "class": "rich-text-code"
            },
            "children": [
              {
                "type": "text",
                "text": "res"
              }
            ]
          },
          {
            "type": "text",
            "text": "\u5bf9\u8c61\u53ef\u4ee5\u5b8c\u5168\u63a7\u5236\u54cd\u5e94\uff1b"
          }
        ]
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u65b9\u6848\u4e00\u6bd4\u8f83\u6b63\u7edf\uff1b\u65b9\u6848\u4e8c\u5219\u5371\u9669\u5f97\u591a\uff0c\u5b98\u65b9\u90fd\u8bf4\u8981\u540e\u679c\u81ea\u8d1f\uff1a"
      }
    ]
  },
  {
    "name": "blockquote",
    "attrs": {
      "class": "rich-text-blockquote"
    },
    "children": [
      {
        "name": "p",
        "attrs": {
          "class": "rich-text-p"
        },
        "children": [
          {
            "type": "text",
            "text": "Bypassing Koa&#39;s response handling is not supported. Avoid using the following node properties: res.statusCode, res.writeHead(), res.write(), res.end()."
          },
          {
            "name": "a",
            "attrs": {
              "class": "rich-text-a"
            },
            "children": [
              {
                "type": "text",
                "text": "via"
              }
            ]
          }
        ]
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u6240\u4ee5\uff0c\u672c\u7ad9\u6700\u7ec8\u91c7\u7528\u4e86\u65b9\u6848\u4e8c\u3002Koa \u603b\u5171\u5c31\u51e0\u4e2a\u6587\u4ef6\uff0c\u51fa\u5565\u5947\u602a\u7684\u95ee\u9898\u90fd\u4e0d\u6015\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u4e0b\u9762\u5f00\u59cb\u8d34\u4ee3\u7801\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "1\uff09\u521b\u5efa Controller \u7684 Extend \u6587\u4ef6"
      },
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "type": "text",
            "text": "src\/extend\/controller.js"
          }
        ]
      },
      {
        "type": "text",
        "text": "\uff1a"
      }
    ]
  },
  {
    "name": "div",
    "attrs": {
      "class": "rich-text-pre"
    },
    "children": [
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "const"
              }
            ]
          },
          {
            "type": "text",
            "text": "firstChunkMinLength ="
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "4096"
              }
            ]
          },
          {
            "type": "text",
            "text": ";"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "module"
              }
            ]
          },
          {
            "type": "text",
            "text": ".exports = {"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "async"
              }
            ]
          },
          {
            "type": "text",
            "text": "renderAndFlush(tpl) {"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "let"
              }
            ]
          },
          {
            "type": "text",
            "text": "content ="
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "await"
              }
            ]
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "this"
              }
            ]
          },
          {
            "type": "text",
            "text": ".render(tpl);"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "\/\/first chunk"
              }
            ]
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "if"
              }
            ]
          },
          {
            "type": "text",
            "text": "(!"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "this"
              }
            ]
          },
          {
            "type": "text",
            "text": ".ctx.headerSent) {"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "this"
              }
            ]
          },
          {
            "type": "text",
            "text": ".ctx.type ="
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "'html'"
              }
            ]
          },
          {
            "type": "text",
            "text": ";"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "this"
              }
            ]
          },
          {
            "type": "text",
            "text": ".ctx.flushHeaders();"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "let"
              }
            ]
          },
          {
            "type": "text",
            "text": "length = content.length;"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "if"
              }
            ]
          },
          {
            "type": "text",
            "text": "(length &lt; firstChunkMinLength) { content +="
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "`&lt;s&gt;"
              },
              {
                "name": "span",
                "attrs": {
                  "class": "rich-text-span"
                },
                "children": [
                  {
                    "type": "text",
                    "text": "${' '.repeat(firstChunkLength -length)}"
                  }
                ]
              },
              {
                "type": "text",
                "text": "&lt;\/s&gt;`"
              }
            ]
          },
          {
            "type": "text",
            "text": "; } }"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "this"
              }
            ]
          },
          {
            "type": "text",
            "text": ".ctx.res.write(content); } };"
          }
        ]
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u8f93\u51fa\u7b2c\u4e00\u4e2a chunk \u4e4b\u524d\uff0c\u9700\u8981\u901a\u8fc7 ctx \u7684"
      },
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "type": "text",
            "text": "type"
          }
        ]
      },
      {
        "type": "text",
        "text": "setter \u548c"
      },
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "type": "text",
            "text": "flushHeaders"
          }
        ]
      },
      {
        "type": "text",
        "text": "\u65b9\u6cd5\u6765\u8f93\u51fa\u54cd\u5e94\u8d77\u59cb\u884c\u548c\u5934\u90e8\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u7b2c\u4e00\u4e2a chunk \u4e0d\u80fd\u592a\u5c0f\uff0c\u5426\u5219\u4f1a\u88ab\u67d0\u4e9b\u6d4f\u89c8\u5668\u7f13\u5b58\u8d77\u6765\uff0c\u4e0d\u4f1a\u9a6c\u4e0a\u663e\u793a\uff0c\u8fbe\u4e0d\u5230\u6211\u4eec\u60f3\u8981\u7684\u6548\u679c\u3002\u66f4\u591a\u7ec6\u8282\u53ef\u4ee5\u70b9\u5f00\u8fd9\u4e2a"
      },
      {
        "name": "a",
        "attrs": {
          "class": "rich-text-a"
        },
        "children": [
          {
            "type": "text",
            "text": "stackoverflow \u7684\u94fe\u63a5"
          }
        ]
      },
      {
        "type": "text",
        "text": "\u81ea\u5df1\u770b\u3002\u53e6\u5916\uff0c\u6211\u5728\u5b9e\u9645\u6d4b\u8bd5\u4e2d\u53d1\u73b0\uff0c\u53ea\u8865\u7a7a\u683c iOS Safari \u4f9d\u7136\u4e0d\u4f1a\u7acb\u523b\u6e32\u67d3\uff0c\u628a\u7a7a\u683c\u653e\u5728\u6807\u7b7e\u91cc\u5c31\u6ca1\u95ee\u9898\u3002\u4e5f\u53ef\u80fd\u662f\u6211\u7684\u5e7b\u89c9\uff0c\u6b22\u8fce\u5927\u5bb6\u6d4b\u8bd5\u5e76\u6307\u6b63\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "2\uff09\u5728 Controller \u91cc\u5c06\u539f\u672c\u6e32\u67d3\u6a21\u677f\u7684\u903b\u8f91\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u62c6\u5206\u4e3a\u591a\u6b65\uff1a"
      }
    ]
  },
  {
    "name": "div",
    "attrs": {
      "class": "rich-text-pre"
    },
    "children": [
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "async"
              }
            ]
          },
          {
            "type": "text",
            "text": "indexAction() {"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "let"
              }
            ]
          },
          {
            "type": "text",
            "text": "pageName ="
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "'blog-home'"
              }
            ]
          },
          {
            "type": "text",
            "text": ";"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "let"
              }
            ]
          },
          {
            "type": "text",
            "text": "title ="
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "'JerryQu \u7684\u5c0f\u7ad9'"
              }
            ]
          },
          {
            "type": "text",
            "text": ";"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "this"
              }
            ]
          },
          {
            "type": "text",
            "text": ".assign({ pageName, title});"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "\/\/\u8f93\u51fa\u5934\u90e8\u548c\u8fb9\u680f HTML"
              }
            ]
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "await"
              }
            ]
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "this"
              }
            ]
          },
          {
            "type": "text",
            "text": ".renderAndFlush("
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "'home\/inc\/header'"
              }
            ]
          },
          {
            "type": "text",
            "text": ");"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "\/\/\u67e5\u8be2\u6570\u636e\u5e93\uff08\u8017\u65f6\u64cd\u4f5c\uff09"
              }
            ]
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "let"
              }
            ]
          },
          {
            "type": "text",
            "text": "pn="
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "this"
              }
            ]
          },
          {
            "type": "text",
            "text": ".get("
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "'pn'"
              }
            ]
          },
          {
            "type": "text",
            "text": ");"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "let"
              }
            ]
          },
          {
            "type": "text",
            "text": "data ="
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "await"
              }
            ]
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "this"
              }
            ]
          },
          {
            "type": "text",
            "text": ".model("
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "'post'"
              }
            ]
          },
          {
            "type": "text",
            "text": ").getPostList(pn,"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "10"
              }
            ]
          },
          {
            "type": "text",
            "text": "); data.pagerPath = getPagerPath("
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "this"
              }
            ]
          },
          {
            "type": "text",
            "text": ".ctx,"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "'pn'"
              }
            ]
          },
          {
            "type": "text",
            "text": ");"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "this"
              }
            ]
          },
          {
            "type": "text",
            "text": ".assign(data);"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "\/\/\u8f93\u51fa\u5269\u4f59 HTML"
              }
            ]
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "return"
              }
            ]
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "this"
              }
            ]
          },
          {
            "type": "text",
            "text": ".display("
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "'home\/index_post_list'"
              }
            ]
          },
          {
            "type": "text",
            "text": "); }"
          }
        ]
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u4e5f\u5c31\u662f\u8bf4\u9700\u8981\u63d0\u524d\u53d1\u9001\u7684\u6a21\u677f\u901a\u8fc7 renderAndFlush \u6765\u6e32\u67d3\u5e76\u53d1\u9001\uff0c\u5269\u4f59\u6a21\u677f\u8fd8\u662f\u8d70\u539f\u6709\u7684 display \u903b\u8f91\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u81f3\u6b64\uff0c\u672c\u6587\u8981\u4ecb\u7ecd\u7684\u4f18\u5316\u5de5\u4f5c\u5df2\u7ecf\u5b8c\u6210\uff0c\u8d76\u7d27\u6253\u5f00\u6d4f\u89c8\u5668\u9a8c\u8bc1\u4e00\u4e0b\u5427\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u4f46\u662f\u5982\u679c\u4f60\u7167\u7740\u6211\u7684\u4ee3\u7801\u6539\u9020\uff0c\u80af\u5b9a\u4f1a\u9047\u5230\u4e0d\u5c11\u5751\uff0c\u4e0b\u9762\u5217\u4e3e\u51e0\u4e2a\uff1a"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "1\uff09\u539f\u672c\u7684\u5f02\u5e38\u903b\u8f91\u91cd\u5b9a\u5411\u5230\u9519\u8bef\u9875\u4e0d\u597d\u7528\uff0c\u76f4\u63a5\u63d0\u793a"
      },
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "type": "text",
            "text": "Can&#39;t set headers after they are sent."
          }
        ]
      },
      {
        "type": "text",
        "text": "\u9519\u8bef\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u8fd9\u4e2a\u9519\u8bef\u4fe1\u606f\u5df2\u7ecf\u628a\u539f\u56e0\u63cf\u8ff0\u5f97\u5f88\u660e\u767d\uff0cHTTP\/1 \u7684\u54cd\u5e94\u9700\u8981\u4e25\u683c\u6309\u7167\u8d77\u59cb\u884c\u3001\u5934\u90e8\u548c\u6b63\u6587\u7684\u987a\u5e8f\u53d1\u9001\uff0c\u5df2\u7ecf\u53d1\u9001\u4e86\u6b63\u6587\uff0c\u5c31\u4e0d\u80fd\u518d\u901a\u8fc7 30X \u72b6\u6001\u7801\u548c"
      },
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "type": "text",
            "text": "Location"
          }
        ]
      },
      {
        "type": "text",
        "text": "\u5934\u90e8\u6765\u8df3\u8f6c\u9875\u9762\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u89e3\u51b3\u65b9\u6848\uff1a\u6709\u4e00\u4e9b\u4f1a\u4ea7\u751f\u8df3\u8f6c\u7684\u903b\u8f91\u4f8b\u5982\u53c2\u6570\u5408\u6cd5\u6027\u68c0\u67e5\uff0c\u53ef\u4ee5\u632a\u5230\u53d1\u9001\u7b2c\u4e00\u4e2a\u5206\u5757\u4e4b\u524d\u6765\u8fdb\u884c\u3002\u53e6\u4e00\u4e9b\u5f02\u5e38\u8df3\u8f6c\u903b\u8f91\u5219\u65e0\u6cd5\u63d0\u524d\uff0c\u4f8b\u5982\u67e5\u8be2\u6570\u636e\u5e93\u540e\u53d1\u73b0\u4e0d\u5b58\u5728\u5bf9\u5e94\u7684\u6587\u7ae0\uff0c\u8fd9\u79cd\u60c5\u51b5\u53ef\u4ee5\u8f93\u51fa\u4e00\u6bb5 JS \u4ee3\u7801\u5728\u6d4f\u89c8\u5668\u4e2d\u8df3\u8f6c\uff0c\u6216\u8005\u76f4\u63a5\u6e32\u67d3\u9519\u8bef\u9875\u9762\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "2\uff09\u63d0\u524d\u8f93\u51fa\u7684\u6a21\u677f\u4e2d\u90e8\u5206\u53d8\u91cf\u53d6\u4e0d\u5230\u503c\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u4f8b\u5982\u672c\u7ad9\u7b2c\u4e00\u4e2a\u5206\u5757\u8f93\u51fa\u4e86\u5de6\u4fa7\u5185\u5bb9\uff0c\u8fd9\u4e2a\u5206\u5757\u5bf9\u5e94\u7684\u6a21\u677f\u4e2d\uff0c\u6709\u5f88\u591a\u5b57\u6bb5\u539f\u672c\u6765\u81ea\u6570\u636e\u5e93\u67e5\u8be2\u540e\u7684\u7ed3\u679c\uff0c\u63d0\u524d\u6e32\u67d3\u5fc5\u7136\u53d6\u4e0d\u5230\u503c\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u89e3\u51b3\u65b9\u6848\uff1a\u8fd9\u4e9b\u9700\u8981\u7528\u5230\u6570\u636e\u5e93\u5b57\u6bb5\u7684\u903b\u8f91\uff0c\u6709\u4e00\u4e9b\u53ef\u4ee5\u632a\u5230\u540e\u7eed\u5206\u5757\u4e2d\uff1b\u6709\u4e00\u4e9b\u5219\u4e0d\u597d\u540e\u79fb\uff0c\u4f8b\u5982\u9700\u8981\u52a8\u6001\u8d4b\u503c\u7684\u9875\u9762"
      },
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "type": "text",
            "text": "&lt;title&gt;"
          }
        ]
      },
      {
        "type": "text",
        "text": "\uff0c\u53ea\u80fd\u653e\u5728"
      },
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "type": "text",
            "text": "&lt;head&gt;"
          }
        ]
      },
      {
        "type": "text",
        "text": "\u91cc\u3002\u4e00\u79cd\u65b9\u6848\u662f\u7ee7\u7eed\u4f7f\u7528\u4e07\u80fd\u7684 JS\uff0c\u901a\u8fc7\u540e\u7eed\u5206\u5757\u4e2d\u7684"
      },
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "type": "text",
            "text": "docuemnt.title"
          }
        ]
      },
      {
        "type": "text",
        "text": "\u6765\u7ed9\u9875\u9762 title \u8d4b\u503c\u3002\u5bf9\u4e8e\u4e0d\u652f\u6301 JS \u7684 Spider\uff0c\u53ef\u4ee5\u7981\u7528\u63d0\u524d\u8f93\u51fa\u54cd\u5e94\u7b56\u7565\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u6211\u4f7f\u7528\u4e86\u53e6\u5916\u4e00\u5957\u65b9\u6848\uff1a\u7531\u4e8e\u6587\u7ae0\u6570\u91cf\u4e0d\u591a\uff0c\u6211\u7d22\u6027\u5728\u7a0b\u5e8f\u542f\u52a8\u65f6\uff0c\u628a\u5168\u90e8\u6587\u7ae0 ID \u548c\u6807\u9898\u5bf9\u5e94\u5173\u7cfb\u4ece\u6570\u636e\u5e93\u53d6\u51fa\u6765\uff0c\u5b58\u5728\u914d\u7f6e\u4e2d\u3002\u8fd9\u6837\uff0c\u540e\u7eed\u7b2c\u4e00\u4e2a\u5206\u5757\u83b7\u53d6\u6807\u9898\u65f6\u65e0\u9700\u67e5\u8be2\u6570\u636e\u5e93\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801\u9700\u8981\u653e\u5728"
      },
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "type": "text",
            "text": "src\/bootstrap\/worker.js"
          }
        ]
      },
      {
        "type": "text",
        "text": "\uff1a"
      }
    ]
  },
  {
    "name": "div",
    "attrs": {
      "class": "rich-text-pre"
    },
    "children": [
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "\/\/HTTP \u670d\u52a1\u542f\u52a8\u524d\u6267\u884c"
              }
            ]
          },
          {
            "type": "text",
            "text": "think.beforeStartServer("
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "async"
              }
            ]
          },
          {
            "type": "text",
            "text": "() =&gt; {"
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "let"
              }
            ]
          },
          {
            "type": "text",
            "text": "postTitle = {}; ("
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "await"
              }
            ]
          },
          {
            "type": "text",
            "text": "think.model("
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "'post'"
              }
            ]
          },
          {
            "type": "text",
            "text": ").field(["
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "'slug'"
              }
            ]
          },
          {
            "type": "text",
            "text": ","
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "'title'"
              }
            ]
          },
          {
            "type": "text",
            "text": "]).select()).forEach(item =&gt; { postTitle[item.slug] = item.title; }); think.config("
          },
          {
            "name": "span",
            "attrs": {
              "class": "rich-text-span"
            },
            "children": [
              {
                "type": "text",
                "text": "'postTitle'"
              }
            ]
          },
          {
            "type": "text",
            "text": ", postTitle); });"
          }
        ]
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "3\uff09Middleware \u4e2d\u83b7\u53d6\u5230\u7684"
      },
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "type": "text",
            "text": "ctx.body"
          }
        ]
      },
      {
        "type": "text",
        "text": "\u4e0d\u662f\u5b8c\u6574\u9875\u9762\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u672c\u65b9\u6848\u53ea\u6709\u6700\u540e\u4e00\u4e2a\u5206\u5757\u5185\u5bb9\u624d\u4f1a\u8d4b\u503c\u7ed9"
      },
      {
        "name": "code",
        "attrs": {
          "class": "rich-text-code"
        },
        "children": [
          {
            "type": "text",
            "text": "ctx.body"
          }
        ]
      },
      {
        "type": "text",
        "text": "\uff0c\u524d\u9762\u5206\u5757\u7684\u8f93\u51fa\u5219\u5b8c\u5168\u7ed5\u8fc7\u4e86 Middleware\uff0c\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\u662f\u6b63\u5e38\u7684\u3002\u5982\u679c\u4f60\u4e0d\u80fd\u63a5\u53d7\uff0c\u8fd8\u662f\u8001\u8001\u5b9e\u5b9e\u7528 Readable Stream \u5427\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u6700\u540e\uff0c\u770b\u5b8c\u672c\u6587\uff0c\u76f8\u4fe1\u4f60\u5bf9\u5982\u4f55\u4f18\u5316 ThinkJS 3 \u7f51\u7ad9\u7684 TTFB \u65f6\u95f4\u6709\u4e86\u8db3\u591f\u4e86\u89e3\uff0c\u8d76\u7d27\u52a8\u624b\u8bd5\u8bd5\u5427\u3002\u9047\u5230\u4efb\u4f55\u95ee\u9898\uff0c\u6b22\u8fce\u7559\u8a00\u8ba8\u8bba\u3002"
      }
    ]
  },
  {
    "name": "p",
    "attrs": {
      "class": "rich-text-p"
    },
    "children": [
      {
        "type": "text",
        "text": "\u672c\u6587\u94fe\u63a5\uff1a"
      },
      {
        "name": "a",
        "attrs": {
          "class": "rich-text-a"
        },
        "children": [
          {
            "type": "text",
            "text": "https:\/\/imququ.com\/post\/reduce-ttfb-on-thinkjs3-website.html"
          }
        ]
      },
      {
        "type": "text",
        "text": "\uff0c"
      },
      {
        "name": "a",
        "attrs": {
          "class": "rich-text-a"
        },
        "children": [
          {
            "type": "text",
            "text": "\u53c2\u4e0e\u8ba8\u8bba"
          }
        ]
      }
    ]
  }
]
